<!DOCTYPE html>
<html lang="en">
	<head>
	<meta charset="UTF-8">
	<title>restore/Mainpage</title>
	<style>
* { outline: 1px solid red; }
th.row-header{text-align: left}
	</style>
	<script src="../public/utils.js"></script>
	<script src="../public/check_session_cookie.js"></script>
	<script src="make_task_list.js"></script>
	<script>

let pending_task_list = fetch_data("/tasks");

function perform_task_action()
{
	window.alert("Hej");
}

window.onload = async function() {
	await redirect_if_not_logged_in(location, document);
	let get_task_list_result = await pending_task_list;
	fill_tasklist(get_task_list_result, document, document.getElementById("tasklist"), perform_task_action);
}

async function refresh_tasklist()
{
	await redirect_if_not_logged_in(location, document);
	let get_task_list_result = await fetch_data("/tasks");
	let tasklist = document.getElementById("tasklist");
	tasklist.replaceChildren();
	fill_tasklist(get_task_list_result, document, tasklist, perform_task_action);
}

	</script>
	</head>
	<body>
		<header><h1>Mainpage</h1></header>
		<main>
			<section>
				<h1>Tasks</h1>
				<nav id="formactions">
					<ul>
						<li><input type="button" value="Refresh" onclick="refresh_tasklist()"></li>
						<li><input type="button" value="Create new task" onclick="location.href='create_task.html'"></li>
					</ul>
				</nav>
				<table id="tasklist">
				</table>
			</section>
		</main>
	</body>
</html>


